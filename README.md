# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Данные и типы данных используемые в проекте

Карточка товара 

```
export interface ICard {
    id: string;
    description: string;
    image: string;
    tittle: string;
    category: string;
    price: number;
}
```

Данные пользователя 

```
export interface IuserData {
    methodPay: string;
    adress: string;
    email: string;
    phone: string;
}
```

Интерфейс для хранения карточек

```
export interface IcardsData {
    cards: ICard[];
    preview: string | null;
}
```

Интерфейс для хранения данных корзины

```
export interface IBasket {
    cards: ICard[] | null;
    totalPrice: number;
    counter: number;
}
```

Данные карточки отражаемой в списке карточек на главной странице

```
export type TCardItemPage = Pick<ICard, "id" |  "image" | "tittle" | "category" | "price">;
```

Данные карточки при открытии попапа с детальной информацией о карточке

```
export type TCard = Pick<ICard, "id" | "description"| "image" | "tittle" | "category" | "price">;
```

Данные карточки в корзине

```
export type TCardBasket = Pick<ICard, "id" |"tittle" | "price">;
```

Данные пользователя вводимые на первом шаге при оформлении 

```
export type TUserDataOne = Pick<IuserData, "methodPay" | "adress">;
```

Данные пользователя вводимые на втором шаге при оформлении

```
export type TUserDataTwo = Pick<IuserData, "email" | "phone">;
```

## Архитектура проекта

Код приложения разделен на слои согласно парадигме MVP:

- Model - слой данных, отвечает за хранение и изменение данных;
- View - слой представления, отвечает за отображение данных на странице;
- Presenter (EventEmitter) - отвечает за связь представления и данных при сработке какого нибудь события, управляя взаимодействием между ними.

### Базовый код

#### Класс Api

Класс реализует методы для взаимодействия с API, обеспечивая базовую логику отправки запросов к серверу. В его конструкторе принимается базовый URL и опциональный объект с глобальными параметрами запроса. Методы класса включают:
- `handleResponse`-  обрабатывает ответы сервера, преобразуя их в формат JSON и управляя возможными ошибками;
 - `get`- выполняет GET-запросы по указанному URL и возвращает промис с объектом-ответом от сервера;
 - `post`- отправляет данные на сервер в формате JSON по указанному URI. В методе post можно указать тип запроса (POST, PUT, DELETE) в качестве опционального параметра, который по умолчанию равен 'POST'.

#### Класс EventEmitter

Класс представляет собой брокер событий и обеспечивает управление событиями в системе.  
Класс реализует интерфейс IEvents, используя типы TEmitterEvent, TSubscriber и TEventName.  
Основные функции EventEmitter включают возможность установки и снятия слушателей событий, а также вызов слушателей при возникновении события.

Методы, реализуемые классом описаны интерфейсом 'IEvents':
  
 
```
on - Регистрация обработчика для указанного события.
```

```
off -  Удаление ранее зарегистрированного обработчика события.
```

```
emit - Инициализация события c переданными данными.
```

```
onAll - Подписка на все события.
```

```
offAll - Удаление всех зарегистрированных обработчиков событий.
```

```
trigger - Возвращает функцию, которая инициирует указанное событие с переданными аргументами при вызове.
```

### Слой данных (Model)

#### Класс CardData

Класс представляет собой структуру данных для управления коллекцией карт и предоставляет методы для доступа к ним.  

```
cards: ICard[] - массив объектов типа ICard, представляющий коллекцию всех карт. Каждая карта содержит информацию, определённую в типе ICard.;
```

```
preview: string | null -  строка, представляющая id карточки, которую выбрали для просмотра в модальном окне;
```

```
events: IEvents - экземпляр класса EventEmitter, для инициализации событий при изменении данных;
```

Для взаимодействия с данными используется метод  

```
getCard(id: string): ICard - метод для получения карты из коллекции по её идентификатору. Принимает идентификатор карты в виде строки и возвращает объект ICard, соответствующий этому идентификатору.
```

#### Класс BasketModel

Класс представляет собой корзину для хранения карт (например, товаров) и управления ими. Он включает в себя свойства и методы для работы с картами, отслеживания их количества и общей стоимости.

```
cardsBasket: ICard[] | null - массив объектов типа ICard, представляющий текущие карты в корзине. Если корзина пуста, свойство может быть null.
```

```
totalPrice: number - общая стоимость всех карт в корзине.
```

```
counter: number - общее количество карт в корзине.
```

```
events: IEvents - экземпляр класса EventEmitter, для инициализации событий при изменении данных;
```

Методы, реализуемые классом:  

```
addCard(card: ICard): void: Метод для добавления новой карты в корзину. Принимает объект ICard и добавляет его в массив cards, увеличивая значение totalPrice на стоимость карты и counter на единицу.
```

```
deleteCard(id: string): void: Метод для удаления карты из корзины. Принимает идентификатор карты в виде строки и удаляет соответствующую карту из массива cards, уменьшая значение totalPrice на стоимость удаленной карты и counter на единицу.
```



### Слой представления (View)

Все классы представления отвечают за отображение внутри контейнера передаваемых в них данных. 


#### Класс Modal

Является компонентом для управления модальными окнами (полной карточки, корзины, заказа, успешного оформления товара). Он наследуется от Component и реализует интерфейс IModalData. Класс предоставляет методы для открытия и закрытия модальных окон, а также для изменения их содержимого.

Свойства
```
_closeButton: HTMLButtonElement - Кнопка для закрытия модального окна.
```

```
_content: HTMLElement - Элемент, содержащий основное содержимое окна.
```
```
events: IEvents - Объект для работы с событиями.
```

Конструктор
```
constructor(container: HTMLElement, events: IEvents) - Инициализирует контейнер, кнопку закрытия и содержимое. Устанавливает обработчики событий для закрытия окна.
```
Методы  
```
set content(value: HTMLElement): Устанавливает новое содержимое окна.
```

```
open() -  Открывает модальное окно, добавляя класс modal_active, и генерирует событие modal:open.
```
```
close() - Закрывает окно, убирая класс modal_active, очищает содержимое и генерирует событие modal:close.
```
```
render(data: IModalData): HTMLElement - Отрисовывает и открывает модальное окно с переданными данными. Возвращает контейнер.
```

#### Класс Card
Класс предназначенный для отображения и управления карточками товара (в каталоге, в попапе и в корзине), а так-же обработку событий пользователя. Реализует интерфейс "ICard". Наследуется от "Component<T>".
Свойства
```
id: string - Идентификатор карточки.
```

```
description: string - Описание карточки.
```

```
image: string - Ссылка на изображение карточки.
```

```
tittle: string - Название карточки.
```

```
category: string - Категория карточки.
```

```
price: number - Цена карточки.
```




#### Класс Basket 

Класс предназначенный для отображения и управления корзиной. Реализует интерфейс "IBasket". Наследуется от "Component<T>".

Свойства
```
cardNumber: number - Количество карточек в корзине.
```

``` 
cardsBasket: ICard[] | null - Массив карточек в корзине.
```

``` 
totalPrice: number - Общая стоимость всех карточек в корзине.
```
методы:

```
renderBasket() - Отрисовывает корзину на странице.
```

```
countCards() - Подсчитываети отображает количество карточек в корзине.
```

#### Класс Page
Класс предназначенный для управления и отображения основных элементов страницы, таких как каталог продуктов, счетчик товаров в корзине, а так же позволяющий блокировать прокрутку страницы.

Выполняемые методы:

```
set counter - Устанавливает новое значение счетчика.
```

```
set cardsList - Устанавливает новое значение списка карточек.
```

```
set locked - Блокирует прокрутку страницы.
```


#### Класс Form

Класс предназначенный для отображения и управления формой. Реализует интерфейс "IFormData". Наследуется от "Component<T>".
свойства 

```
methodPay: string - Способ оплаты.
```

```
adress: string - Адрес доставки.
```

```
phone: string - Номер телефона.
```

```
email: string - Электронная почта.
```

методы:

```
set valid(value: boolean) - Устанавливает новое значение валидации.
```

```
renderForm() - Отрисовывает форму на странице.
```
```
setPayMethod() - Устанавливает способ оплаты.
```
```
setAdress() - Устанавливает адрес доставки.
```
```
setPhone() - Устанавливает номер телефона.
```
```
setEmail() - Устанавливает электронную почту.
```

#### Класс Success

Клас отображает окно с данными о успешно оформленном заказе и показывает общую количество списанных деняк. Реализует интерфейс "ISuccess". Наследуется от "Component<T>".

свойства 

```
totalPrice: number - Общая стоимость всех купленных карточек.
```

методы:

```
renderSuccess() - Отрисовывает окно с данными о успешно оформленном заказе.
```

### Слой Presenter

 "EventEmitter" обеспечивает связь и обмен данными между "Model" и "View".



